package com.goudong.authentication.server.service;

import cn.hutool.json.JSONArray;
import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.type.CollectionType;
import com.goudong.authentication.server.service.dto.BaseMenuDTO;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.extension.ExtendWith;

import java.util.List;

/**
 * 类描述：
 *
 * @author chenf
 * @version 1.0
 */
@ExtendWith({})
public class TreeTest {
    //~fields
    //==================================================================================================================

    //~methods
    //==================================================================================================================
    @Test
    void test1() throws JsonProcessingException {
        String json = "[{\"id\":\"1667829212070445056\",\"appId\":\"1\",\"permissionId\":\"sys\",\"name\":\"系统管理\",\"type\":1,\"path\":\"/user\",\"sortNum\":1,\"hide\":false,\"meta\":\"{\\\"icon\\\": \\\"el-icon-s-tools\\\", \\\"title\\\": \\\"系统管理\\\"}\",\"children\":[{\"id\":\"1667829212074639360\",\"parentId\":\"1667829212070445056\",\"appId\":\"1\",\"permissionId\":\"sys:user\",\"name\":\"用户管理\",\"type\":1,\"path\":\"/user/index\",\"sortNum\":2,\"hide\":false,\"meta\":\"{\\\"icon\\\": \\\"peoples\\\", \\\"title\\\": \\\"用户管理\\\"}\",\"children\":[{\"id\":\"1667829212074639361\",\"parentId\":\"1667829212074639360\",\"appId\":\"1\",\"permissionId\":\"sys:user:query\",\"name\":\"查询用户\",\"type\":2,\"path\":\"/api/user/base-user/page\",\"method\":\"[\\\"GET\\\"]\",\"sortNum\":3,\"hide\":false,\"remark\":\"菜单啊\",\"createdDate\":\"2023-09-21 17:03:24\",\"checked\":false},{\"id\":\"1667829212074639362\",\"parentId\":\"1667829212074639360\",\"appId\":\"1\",\"permissionId\":\"sys:user:add\",\"name\":\"新增用户\",\"type\":2,\"path\":\"/api/user/base-user/simple-create-user\",\"method\":\"[\\\"POST\\\"]\",\"sortNum\":4,\"hide\":false,\"meta\":\"{\\\"name\\\": \\\"cfl\\\"}\",\"remark\":\"菜单啊\",\"createdDate\":\"2023-09-21 17:03:24\",\"checked\":false},{\"id\":\"1667829212074639364\",\"parentId\":\"1667829212074639360\",\"appId\":\"1\",\"permissionId\":\"sys:user:edit\",\"name\":\"编辑用户\",\"type\":2,\"path\":\"/api/user/base-user/admin/user\",\"method\":\"[\\\"PUT\\\"]\",\"sortNum\":6,\"hide\":false,\"remark\":\"菜单啊\",\"createdDate\":\"2023-09-21 17:03:24\",\"checked\":false},{\"id\":\"1667829212074639365\",\"parentId\":\"1667829212074639360\",\"appId\":\"1\",\"permissionId\":\"sys:user:delete\",\"name\":\"删除用户\",\"type\":2,\"path\":\"/api/user/base-user/*\",\"method\":\"[\\\"DELETE\\\"]\",\"sortNum\":7,\"hide\":false,\"remark\":\"菜单啊\",\"createdDate\":\"2023-09-21 17:03:24\",\"checked\":false},{\"id\":\"1675371942527033344\",\"parentId\":\"1667829212074639360\",\"appId\":\"1\",\"permissionId\":\"sys:user:reset-password\",\"name\":\"重置密码\",\"type\":2,\"path\":\"/api/user/base-user/reset-password/*\",\"method\":\"[\\\"PUT\\\"]\",\"sortNum\":7,\"hide\":false,\"remark\":\"菜单啊\",\"createdDate\":\"2023-09-21 17:03:24\",\"checked\":false},{\"id\":\"1676554953243148288\",\"parentId\":\"1667829212074639360\",\"appId\":\"1\",\"permissionId\":\"sys:user:enable\",\"name\":\"激活用户\",\"type\":2,\"path\":\"/api/user/base-user/change-enabled/*\",\"method\":\"[\\\"PUT\\\"]\",\"sortNum\":7,\"hide\":false,\"remark\":\"菜单啊\",\"createdDate\":\"2023-09-21 17:03:24\",\"checked\":false},{\"id\":\"1676554953243148289\",\"parentId\":\"1667829212074639360\",\"appId\":\"1\",\"permissionId\":\"sys:user:lock\",\"name\":\"锁定用户\",\"type\":2,\"path\":\"/api/user/base-user/change-locked/*\",\"method\":\"[\\\"PUT\\\"]\",\"sortNum\":8,\"hide\":false,\"remark\":\"菜单啊\",\"createdDate\":\"2023-09-21 17:03:24\",\"checked\":false}],\"checked\":false},{\"id\":\"1667829212078833664\",\"parentId\":\"1667829212070445056\",\"appId\":\"1\",\"permissionId\":\"sys:role\",\"name\":\"角色管理\",\"type\":1,\"path\":\"/role/index\",\"sortNum\":8,\"hide\":false,\"meta\":\"{\\\"icon\\\": \\\"iconfont-jueseguanli\\\", \\\"title\\\": \\\"角色管理\\\"}\",\"children\":[{\"id\":\"1667829212078833665\",\"parentId\":\"1667829212078833664\",\"appId\":\"1\",\"permissionId\":\"sys:role:query\",\"name\":\"查询角色\",\"type\":2,\"path\":\"/api/user/base-role/page\",\"method\":\"[\\\"GET\\\"]\",\"sortNum\":9,\"hide\":false,\"remark\":\"菜单啊\",\"createdDate\":\"2023-09-21 17:03:24\",\"checked\":false},{\"id\":\"1667829212078833666\",\"parentId\":\"1667829212078833664\",\"appId\":\"1\",\"permissionId\":\"sys:role:add\",\"name\":\"新增角色\",\"type\":2,\"path\":\"/api/user/base-role\",\"method\":\"[\\\"POST\\\"]\",\"sortNum\":10,\"hide\":false,\"remark\":\"菜单啊\",\"createdDate\":\"2023-09-21 17:03:24\",\"checked\":false},{\"id\":\"1667829212078833667\",\"parentId\":\"1667829212078833664\",\"appId\":\"1\",\"permissionId\":\"sys:role:edit\",\"name\":\"编辑角色\",\"type\":2,\"path\":\"/api/user/base-role\",\"method\":\"[\\\"PUT\\\"]\",\"sortNum\":11,\"hide\":false,\"remark\":\"菜单啊\",\"createdDate\":\"2023-09-21 17:03:24\",\"checked\":false},{\"id\":\"1667829212078833668\",\"parentId\":\"1667829212078833664\",\"appId\":\"1\",\"permissionId\":\"sys:role:delete\",\"name\":\"删除角色\",\"type\":2,\"path\":\"/api/user/base-role/*\",\"method\":\"[\\\"DELETE\\\"]\",\"sortNum\":12,\"hide\":false,\"remark\":\"菜单啊\",\"createdDate\":\"2023-09-21 17:03:24\",\"checked\":false},{\"id\":\"1667829212078833669\",\"parentId\":\"1667829212078833664\",\"appId\":\"1\",\"permissionId\":\"sys:role:permission\",\"name\":\"分配权限\",\"type\":2,\"path\":\"/api/user/base-role/permissions/*\",\"method\":\"[\\\"POST\\\"]\",\"sortNum\":13,\"hide\":false,\"remark\":\"菜单啊\",\"createdDate\":\"2023-09-21 17:03:24\",\"checked\":false}],\"checked\":false},{\"id\":\"1667829212078833670\",\"parentId\":\"1667829212070445056\",\"appId\":\"1\",\"permissionId\":\"sys:menu\",\"name\":\"菜单管理\",\"type\":1,\"path\":\"/menu/index\",\"sortNum\":14,\"hide\":false,\"meta\":\"{\\\"icon\\\": \\\"iconfont-caidanguanli\\\", \\\"title\\\": \\\"菜单管理\\\"}\",\"children\":[{\"id\":\"1667829212078833671\",\"parentId\":\"1667829212078833670\",\"appId\":\"1\",\"permissionId\":\"sys:menu:query\",\"name\":\"查询菜单\",\"type\":2,\"path\":\"/api/user/base-menu/tree\",\"method\":\"[\\\"GET\\\"]\",\"sortNum\":15,\"hide\":false,\"remark\":\"菜单啊\",\"createdDate\":\"2023-09-21 17:03:24\",\"checked\":false},{\"id\":\"1675371942527033345\",\"parentId\":\"1667829212078833670\",\"appId\":\"1\",\"permissionId\":\"sys:menu:init\",\"name\":\"初始菜单\",\"type\":2,\"path\":\"/api/user/base-menu/init\",\"method\":\"[\\\"POST\\\"]\",\"sortNum\":15,\"hide\":false,\"remark\":\"菜单啊\",\"createdDate\":\"2023-09-21 17:03:24\",\"checked\":false},{\"id\":\"1676554953251536896\",\"parentId\":\"1667829212078833670\",\"appId\":\"1\",\"permissionId\":\"sys:menu:add\",\"name\":\"新增菜单\",\"type\":2,\"path\":\"/api/user/base-menu\",\"method\":\"[\\\"POST\\\"]\",\"sortNum\":19,\"hide\":false,\"remark\":\"菜单啊\",\"createdDate\":\"2023-09-21 17:03:24\",\"checked\":false},{\"id\":\"1676554953251536897\",\"parentId\":\"1667829212078833670\",\"appId\":\"1\",\"permissionId\":\"sys:menu:edit\",\"name\":\"编辑菜单\",\"type\":2,\"path\":\"/api/user/base-menu\",\"method\":\"[\\\"PUT\\\"]\",\"sortNum\":20,\"hide\":false,\"remark\":\"菜单啊\",\"createdDate\":\"2023-09-21 17:03:24\",\"checked\":false},{\"id\":\"1676554953251536898\",\"parentId\":\"1667829212078833670\",\"appId\":\"1\",\"permissionId\":\"sys:menu:delete\",\"name\":\"删除菜单\",\"type\":2,\"path\":\"/api/user/base-menu/*\",\"method\":\"[\\\"DELETE\\\"]\",\"sortNum\":21,\"hide\":false,\"remark\":\"菜单啊\",\"createdDate\":\"2023-09-21 17:03:24\",\"checked\":false}],\"checked\":false},{\"id\":\"1667829212087222272\",\"parentId\":\"1667829212070445056\",\"appId\":\"1\",\"permissionId\":\"sys:app\",\"name\":\"应用管理\",\"type\":1,\"path\":\"/app/index\",\"sortNum\":16,\"hide\":false,\"meta\":\"{\\\"icon\\\": \\\"iconfont-yingyongguanli\\\", \\\"title\\\": \\\"应用管理\\\"}\",\"children\":[{\"id\":\"1675371942531227648\",\"parentId\":\"1667829212087222272\",\"appId\":\"1\",\"permissionId\":\"sys:app:query\",\"name\":\"查询应用\",\"type\":2,\"path\":\"/api/authentication-server/app/page/base-app\",\"method\":\"[\\\"POST\\\"]\",\"sortNum\":18,\"hide\":false,\"remark\":\"菜单啊\",\"createdDate\":\"2023-09-21 17:03:24\",\"checked\":false},{\"id\":\"1675371942531227649\",\"parentId\":\"1667829212087222272\",\"appId\":\"1\",\"permissionId\":\"sys:app:apply\",\"name\":\"申请应用\",\"type\":2,\"path\":\"/api/authentication-server/base-app\",\"method\":\"[\\\"POST\\\"]\",\"sortNum\":19,\"hide\":false,\"remark\":\"菜单啊\",\"createdDate\":\"2023-09-21 17:03:24\",\"checked\":false},{\"id\":\"1675371942531227650\",\"parentId\":\"1667829212087222272\",\"appId\":\"1\",\"permissionId\":\"sys:app:audit\",\"name\":\"审核应用\",\"type\":2,\"path\":\"/api/oauth2/base-app/audit\",\"method\":\"[\\\"PUT\\\"]\",\"sortNum\":20,\"hide\":false,\"remark\":\"菜单啊\",\"createdDate\":\"2023-09-21 17:03:24\",\"checked\":false},{\"id\":\"1675371942531227651\",\"parentId\":\"1667829212087222272\",\"appId\":\"1\",\"permissionId\":\"sys:app:delete\",\"name\":\"删除应用\",\"type\":2,\"path\":\"/api/oauth2/base-app/*\",\"method\":\"[\\\"DELETE\\\"]\",\"sortNum\":21,\"hide\":false,\"remark\":\"菜单啊\",\"createdDate\":\"2023-09-21 17:03:24\",\"checked\":false}],\"checked\":false}],\"checked\":false}]";
        ObjectMapper om = new ObjectMapper();
        List list = om.readValue(json, List.class);

        //方法一
        CollectionType setType = om.getTypeFactory().constructCollectionType(List.class, BaseMenuDTO.class);
        List<BaseMenuDTO> convertPojos = om.readValue(json, setType);
        System.out.println("convertPojos: " + convertPojos);
    }
}
